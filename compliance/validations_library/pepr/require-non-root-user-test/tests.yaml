pass:
  - test: default
    validation: validation.yaml
    resources: resources.json
    expected-validation: true
  - test: add-disallowed-pod
    validation: validation.yaml
    resources: resources.json
    permutation: '.requireNonRootUser += [{"apiVersion": "v1", "kind": "Pod", "metadata": { "name": "not-allowed-pod", "namespace": "default"}}]'
    expected-validation: false
  - test: remove-allowed-pod
    validation: validation.yaml
    resources: resources.json
    permutation: 'del(.requireNonRootUser[] | select(.metadata.name == "require-non-root-user-9"))'
    expected-validation: false